# 压力监测仪测试工装 - 测试流程说明文档

> **版本说明：** 当前固件版本为 **压力监测仪工装专用版本**
> - **UART配置说明：**
>   - UART0: PC上位机通信
>   - UART1: 红外通信（通用工装老水表标准程序使用，带前导码）
>   - UART3: 预留
>   - **UART4: 压力监测仪主控板通信（MCU TXD/RXD常规串口，无需前导码）✓**
> - **与水表工装的区别：**
>   - 水表工装使用UART1红外通信（需要前导码）
>   - 压力监测仪工装使用UART4常规串口（无需前导码）
>   - `tongxin_xieyi_Ctrl.c` 已修改为使用 `Uart4_Tx_Send()` 替代 `Uart1_Tx_Send_ok()`

---

### 测试流程说明：
#### Step 0:上电初始化相关配置，关闭所有对外IO端口;等待上位发送开始测试指令，上位发送68 AA 06 00 18 16之后,工装校验没有问题，执行test_start对相关端口初始化（关闭相关端口，然后设置debug set端口开启) ，然后工装对上位发送响应帧：68 AB 06 00 19 16
##### 上电初始化配置如下：
- 初始化相关IO端口，工位端口，Uart端口
- 初始化Uart端口配置（详见上方版本说明）
-
- 初始化时钟配置
- 初始化其他（后续补充)
#####  具体相关初始化配置如下：
- 3.6V供电给压力监测仪主控板VIN 网络
- 开启debug_set
- 其他无关的电源还是什么全都关闭
#### Step 1: 先检测工装线路板3.6V是否正常，采样看看是否在范围之内;没有问题，就对压力监测仪主控板供电，供电VIN,然后压力监测仪的的3.3V电压，没有问题，进行下一步

#### Step 2:发送查询指令，这个和压力监测仪主控板开发约定好就是相当于对方开始测试，对方会开始测试Flash,蓝牙等默认内容，我后续只需要发送查询指令即可
##### 查询指令：68 FF FF FF FF FF FF 68 01 0A 00 25 09 22 10 10 10 0F 14 10 00 88 16
##### 透传模式的具体日志信息：
```
<< 压力监测仪主控板->PC: 协议数据 (16 字节): 0D 0A 53 45 4E 53 4F 52 20 45 52 52 4F 52 0D 0A
>> PC->压力监测仪: 协议数据 (23 字节): 68 FF FF FF FF FF FF 68 01 0A 00 25 09 22 10 10 10 0F 14 10 00 88 16
<< 压力监测仪主控板->PC: 协议数据 (158 字节): 68 00 00 00 00 00 00 68 81 4D 00 25 10 23 16 06 36 00 14 10 00 22 00 38 36 31 34 32 39 30 37 30 35 34 35 30 33 32 34 36 30 32 34 30 32 37 34 33 32 38 38 34 34 38 39 38 36 30 38 34 37 31 31 32 34 39 30 37 39 38 38 34 36 1F 00 00 00 FF FF 00 01 00 2B 03 10 17 0A 19 63 16 0D 0A 42 4C 45 20 4F 4E 0D 0A 00 00 00 00 00 00 68 81 4D 00 25 10 23 16 06 36 00 14 10 00 22 00 38 36 31 34 32 39 30 37 30 35 34 35 30 33 32 34 36 30 32 34 30 32 37 34 33 32 38 38 34 34 38 39 38 36 30 38
<< 压力监测仪主控板->PC: 协议数据 (53 字节): 42 30 30 37 20 43 6D 64 20 52 65 63 65 69 76 65 64 2E 0D 0A 44 65 76 69 63 65 20 4E 61 6D 65 3A 20 57 58 50 4D 54 2D 30 30 30 30 30 30 30 30 30 30 30 30 0D 0A
<< 压力监测仪主控板->PC: 协议数据 (20 字节): 42 30 30 44 20 43 6D 64 20 52 65 63 65 69 76 65 64 2E 0D 0A
<< 压力监测仪主控板->PC: 协议数据 (16 字节): 0D 0A 53 45 4E 53 4F 52 20 45 52 52 4F 52 0D 0A
>> PC->压力监测仪: 协议数据 (23 字节): 68 FF FF FF FF FF FF 68 01 0A 00 25 09 22 10 10 10 0F 14 10 00 88 16
<< 压力监测仪主控板->PC: 协议数据 (90 字节): 68 00 00 00 00 00 00 68 81 4D 00 25 10 23 16 06 48 00 14 10 00 22 00 38 36 31 34 32 39 30 37 30 35 34 35 30 33 32 34 36 30 32 34 30 32 37 34 33 32 38 38 34 34 38 39 38 36 30 38 34 37 31 31 32 34 39 30 37 39 38 38 34 36 1F 01 00 00 FF FF 01 01 00 2B 03 10 17 0A 19 77 16

```

